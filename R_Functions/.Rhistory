library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
setwd("E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/")
source("./8.6_stats_func.R")
source("./Func_Def_Experiment_2.1.a.R")
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename <- paste(project_directory,"Raw_pos.csv",sep="")
df <- read.csc(filename)
df <- read.csv(filename)
df <- get_df_WT(df)
df <- get_df_P2(df)
df
df_pos <- get_df_Pos(df)
df_neg <- get_df_Neg(df)
y_pos <- sort(df_Pos$Distance)
y_pos <- sort(df_pos$Distance)
y_neg <- sort(df_neg$Distance)
y_pos
df_pos <- get_df_Pos(df)
df_neg <- get_df_Neg(df)
df_pos
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename <- paste(project_directory,"Raw_pos.csv",sep="")
df <- read.csv(filename)
df <- get_df_WT(df)
df <- get_df_P2(df)
df
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename <- paste(project_directory,"Raw_pos.csv",sep="")
df <- read.csv(filename)
df <- get_df_WT(df)
df <- get_df_P2(df)
df
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename)
df2 <- read.csv(filename)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
df_pos <- get_df_Pos(df1)
df_neg <- get_df_Neg(df2)
y_pos <- sort(df_pos$Distance)
y_neg <- sort(df_neg$Distance)
y_pos
cumsum(y_pos)
max(cumsum(y_pos))
df_Pos$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df_pos$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df_neg$Cumsum_Distance <- cumsum(x_pos)/max(cumsum(x_pos))
df_neg$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename)
df2 <- read.csv(filename)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
df_pos <- get_df_Pos(df1)
df_neg <- get_df_Neg(df2)
y_pos <- sort(df_pos$Distance)
y_neg <- sort(df_neg$Distance)
df_pos$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df_neg$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df_neg$Cumsum_Distance <- cumsum(y_neg)/max(cumsum(y_neg))
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename)
df2 <- read.csv(filename)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
df_pos <- get_df_Pos(df1)
df_neg <- get_df_Neg(df2)
y_pos <- sort(df_pos$Distance)
y_neg <- sort(df_neg$Distance)
df_pos$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df_neg$Cumsum_Distance <- cumsum(y_neg)/max(cumsum(y_neg))
y_neg
df_neg
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename)
df2 <- read.csv(filename)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
df2
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
y_pos <- sort(df1$Distance)
y_neg <- sort(df2$Distance)
y_pos
y_neg
df_pos$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df_neg$Cumsum_Distance <- cumsum(y_neg)/max(cumsum(y_neg))
y_neg
max(cumsum(y_neg))
cumsum(y_neg)
cumsum(y_neg)/max(cumsum(y_neg))
df_neg
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
y_pos <- sort(df1$Distance)
y_neg <- sort(df2$Distance)
df1s$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
y_pos <- sort(df1$Distance)
y_neg <- sort(df2$Distance)
df1$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df2$Cumsum_Distance <- cumsum(y_neg)/max(cumsum(y_neg))
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
setwd("E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/")
source("./8.6_stats_func.R")
source("./Func_Def_Experiment_2.1.a.R")
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
y_pos <- sort(df1$Distance)
y_neg <- sort(df2$Distance)
df1$Cumsum_Distance <- cumsum(y_pos)/max(cumsum(y_pos))
df2$Cumsum_Distance <- cumsum(y_neg)/max(cumsum(y_neg))
df1
df2
df1
y_pos <- sort(df1$Distance)
y_neg <- sort(df2$Distance)
df1$Cumsum_Distance <- cumsum(y_pos)
df2$Cumsum_Distance <- cumsum(y_neg)
df1
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
df1_sort <- df1[order(df1$Distance),]
df2_sort <- df2[order(df2$Distance),]
df1_sort
df1_sort$Index <- 1:length(df1$Distance)
df1_sort
df1_sort <- df1[order(df1$Distance),]
df2_sort <- df2[order(df2$Distance),]
df1_sort$Index <- 1:length(df1_sort$Distance)
df2_sort$Index <- 1:length(df2_sort$Distance)
df1_sort$norm_Index <- df1_sort$Index/max(df1_sort$Index)
df2_sort$norm_Index <- df2_sort$Index/max(df2_sort$Index)
df1_sort$cumsum <- cumsum(df1_sort$Distance)
df2_sort$cumsum <- cumsum(df2_sort$Distance)
df <- rbind(df1_sort,df2_sort)
df
ggplot(data=df,aes(x=cumsum,y=norm_Index,fill=CTB)) +
geom_line() +
coord_cartesian(ylim=yrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
yrange=c(0,100)
ggplot(data=df,aes(x=cumsum,y=norm_Index,fill=CTB)) +
geom_line() +
coord_cartesian(ylim=yrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
Exp11_cumsum <- function(df1,df2,xrange=c(0,1)){
df1_sort <- df1[order(df1$Distance),]
df2_sort <- df2[order(df2$Distance),]
df1_sort$Index <- 1:length(df1_sort$Distance)
df2_sort$Index <- 1:length(df2_sort$Distance)
df1_sort$norm_Index <- df1_sort$Index/max(df1_sort$Index)
df2_sort$norm_Index <- df2_sort$Index/max(df2_sort$Index)
df1_sort$cumsum <- cumsum(df1_sort$Distance)
df2_sort$cumsum <- cumsum(df2_sort$Distance)
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=cumsum,y=norm_Index,fill=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
}
ggplot(data=df,aes(x=cumsum,y=norm_Index,fill=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
xrange=c(0,100)
ggplot(data=df,aes(x=cumsum,y=norm_Index,fill=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
df1 <- get_df_P2(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P2(df2)
df1_sort <- df1[order(df1$Distance),]
df2_sort <- df2[order(df2$Distance),]
df1_sort$cumsum <- cumsum(df1_sort$Distance)
df2_sort$cumsum <- cumsum(df2_sort$Distance)
df1_sort$norm_cumsum <- df1_sort$cumsum/max(df1_sort$cumsum)
df2_sort$norm_cumsum <- df2_sort$cumsum/max(df2_sort$cumsum)
df <- rbind(df1_sort,df2_sort)
xrange=c(0,20)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,fill=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
xrange=c(0,30)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,fill=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df1 <- get_df_WT(df1)
df1 <- get_df_P4(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P4(df2)
df1_sort <- df1[order(df1$Distance),]
df2_sort <- df2[order(df2$Distance),]
df1_sort$cumsum <- cumsum(df1_sort$Distance)
df2_sort$cumsum <- cumsum(df2_sort$Distance)
df1_sort$norm_cumsum <- df1_sort$cumsum/max(df1_sort$cumsum)
df2_sort$norm_cumsum <- df2_sort$cumsum/max(df2_sort$cumsum)
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,fill=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
df1 <- get_df_P4(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P4(df2)
df1
df2
df1_sort <- df1[order(df1$Distance),]
df2_sort <- df2[order(df2$Distance),]
df1_sort
df1_sort$cumsum <- cumsum(df1_sort$Distance)
df2_sort$cumsum <- cumsum(df2_sort$Distance)
df1_sort$cumsum
df1_sort$norm_cumsum <- df1_sort$cumsum/max(df1_sort$cumsum)
df2_sort$norm_cumsum <- df2_sort$cumsum/max(df2_sort$cumsum)
df1_sort$norm_cumsum
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,fill=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
ggplot(data=df,aes(x=Distance,y=norm_cumsum,group=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
xrange=c(0,20)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,color=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
get_norm_cumsum <- function(df,target){
df_sort <- df[order(df1$target),]
df_sort$cumsum <- cumsum(df_sort$target)
df_sort$norm_cumsum <- df_sort$cumsum/max(df_sort$cumsum)
return(df)
}
df
df1 <- get_norm_cumsum(df)
df1 <- get_norm_cumsum(df,Distance)
df1 <- get_norm_cumsum(df,'Distance')
df1 <- get_norm_cumsum(df,"Distance")
df
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
df1 <- get_df_P4(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P4(df2)
df1_sort <- get_norm_cumsum(df1,"Distance")
get_norm_cumsum <- function(df,target){
df_sort <- df[order(df1[[target]]),]
df_sort$cumsum <- cumsum(df_sort[[target]])
df_sort$norm_cumsum <- df_sort$cumsum/max(df_sort$cumsum)
return(df)
}
df1_sort <- get_norm_cumsum(df1,"Distance")
df1_sort
get_norm_cumsum <- function(df,target){
df_sort <- df[order(df1[[target]]),]
df_sort$cumsum <- cumsum(df_sort[[target]])
df_sort$norm_cumsum <- df_sort$cumsum/max(df_sort$cumsum)
return(df_sort)
}
df1_sort <- get_norm_cumsum(df1,"Distance")
df1_sort
source("./8.6_stats_func.R")
source("./Func_Def_Cumsum_Utilty.R")
source("./Func_Def_Cumsum_Utility.R")
df1_sort <- get_norm_cumsum(df1)
df1_sort <- get_norm_cumsum(df1,"Distance")
df2_sort <- get_norm_cumsum(df2,"Distance")
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,color=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange) + coord_cartesian(ylim=c(0,1))
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df1_sort <- get_norm_cumsum(df1,"Distance")
df2_sort <- get_norm_cumsum(df2,"Distance")
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,color=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange,ylim=c(0,1)) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
df1 <- get_df_WT(df1)
df1 <- get_df_P4(df1)
df2 <- get_df_WT(df2)
df2 <- get_df_P4(df2)
df1_sort <- get_norm_cumsum(df1,"Distance")
df2_sort <- get_norm_cumsum(df2,"Distance")
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,color=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange,ylim=c(0,1)) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
get_norm_cumsum <- function(df,target){
df_sort <- df[order(df[[target]]),]
df_sort$cumsum <- cumsum(df_sort[[target]])
df_sort$norm_cumsum <- df_sort$cumsum/max(df_sort$cumsum)
return(df_sort)
}
df1_sort <- get_norm_cumsum(df1,"Distance")
df2_sort <- get_norm_cumsum(df2,"Distance")
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,color=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange,ylim=c(0,1)) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df1_WT_P2 <- get_df_P2(df1_WT)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
setwd("E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/")
source("./8.6_stats_func.R")
source("./Func_Def_Cumsum_Utility.R")
Exp11_cumsum <- function(df1,df2,outpath,filename,xrange=c(0,15)){
df1_sort <- get_norm_cumsum(df1,"Distance")
df2_sort <- get_norm_cumsum(df2,"Distance")
df <- rbind(df1_sort,df2_sort)
ggplot(data=df,aes(x=Distance,y=norm_cumsum,color=CTB)) +
geom_line() +
coord_cartesian(xlim=xrange,ylim=c(0,1)) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
ggsave(path = outpath,filename=paste(filename,".eps",sep=""))
ggsave(path = outpath,filename=paste(filename,".png",sep=""))
}
Comp_CTB_at_each_Age_ANOVA <- function(df,yname,groupname){
df_P2 <- get_df_P2(df)
df_P4 <- get_df_P4(df)
df_P8 <- get_df_P8(df)
#
df_P2.aov <- aov(reformulate(groupname,yname),data=df_P2)
print(summary(df_P2.aov))
df_P4.aov <- aov(reformulate(groupname,yname),data=df_P4)
print(summary(df_P4.aov))
df_P8.aov <- aov(reformulate(groupname,yname),data=df_P8)
print(summary(df_P8.aov))
}
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_11_beyond1.5/"
filename1 <- paste(project_directory,"Raw_pos.csv",sep="")
filename2 <- paste(project_directory,"Raw_neg.csv",sep="")
df1 <- read.csv(filename1)
df2 <- read.csv(filename2)
#Data prep
{
#Data prep
df1_WT <- get_df_WT(df1)
df1_B2 <- get_df_B2(df1)
df1_WT_P2 <- get_df_P2(df1_WT)
df1_WT_P4 <- get_df_P4(df1_WT)
df1_WT_P8 <- get_df_P8(df1_WT)
df1_B2_P2 <- get_df_P2(df1_B2)
df1_B2_P4 <- get_df_P4(df1_B2)
df1_B2_P8 <- get_df_P8(df1_B2)
df2_WT <- get_df_WT(df2)
df2_B2 <- get_df_B2(df2)
df2_WT_P2 <- get_df_P2(df2_WT)
df2_WT_P4 <- get_df_P4(df2_WT)
df2_WT_P8 <- get_df_P8(df2_WT)
df2_B2_P2 <- get_df_P2(df2_B2)
df2_B2_P4 <- get_df_P4(df2_B2)
df2_B2_P8 <- get_df_P8(df2_B2)
}
Exp11_cumsum(df1_WT_P2,df2_WT_P2,project_directory,"WTP2")
Exp11_cumsum(df1_WT_P4,df2_WT_P4,project_directory,"WTP4")
Exp11_cumsum(df1_WT_P8,df2_WT_P8,project_directory,"WTP8")
Exp11_cumsum(df1_B2_P2,df2_B2_P2,project_directory,"B2P2")
Exp11_cumsum(df1_B2_P4,df2_B2_P4,project_directory,"B2P4")
Exp11_cumsum(df1_B2_P8,df2_B2_P8,project_directory,"B2P8")
df_sort
result <- ks.test(df1$Distance,df2$Distance)
result
statistics_outfile <- paste(project_directory,"statistics.txt",sep="")
sink(file=statistics_outfile)
print("WTP2")
Comp_CTB_at_each_Age_KS(df1_WT_P2,df2_WT_P2)
Comp_CTB_at_each_Age_KS <- function(df1,df2){
ks.test(df1$Distance,df2$Distance)
print(result)
}
statistics_outfile <- paste(project_directory,"statistics.txt",sep="")
sink(file=statistics_outfile)
print("WTP2")
Comp_CTB_at_each_Age_KS(df1_WT_P2,df2_WT_P2)
print("WTP4")
Comp_CTB_at_each_Age_KS(df1_WT_P4,df2_WT_P4)
print("WTP8")
Comp_CTB_at_each_Age_KS(df1_WT_P8,df2_WT_P8)
print("B2P2")
Comp_CTB_at_each_Age_KS(df1_B2_P2,df2_B2_P2)
print("B2P4")
Comp_CTB_at_each_Age_KS(df1_B2_P4,df2_B2_P4)
print("B2P8")
Comp_CTB_at_each_Age_KS(df1_B2_P8,df2_B2_P8)
sink(NULL)
closeAllConnections()
