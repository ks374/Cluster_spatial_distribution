package.install(ggplot2)
install.package(ggplot2)
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df<-df[df$CTB=='Pos',]
df <= get_df_WT(df)
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
source("./8.6_Statistics_revisit.R")
source("./8.6_Statistics_revisit.R")
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
source("./8.6_Statistics_revisit.R")
source("8.6_Statistics_revisit.R")
source("./8.6_Statistics_revisit.R")
getwd()
setwd('E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions')
source("./8.6_Statistics_revisit.R")
setwd("E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions")
source("./8.6_Statistics_revisit.R")
getwd()
setwd("E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/")
source("./8.6_Statistics_revisit.R")
file.choose()
setwd("E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/")
source("./8.6_Statistics_revisit.R")
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df<-df[df$CTB=='Pos',]
df <= get_df_WT(df)
df <- get_df_WT(df)
df
df <- read.xlsx(filename,sheet=1)
df <- get_df_WT(df)
df <- get_df_Pos(df)
df
get_rid_of_rand <- function(df){
return(df[(df$Type=='Multi_orig' | df$Type=='Singl_orig'),])
}
df <- get_rid_of_rand(df)
df
df_P2 <- get_df_P2(df)
df_P4 <- get_df_P4(df)
df_P8 <- get_df_P8(df)
df+P2
df_P2
df_P2_Pos <- as.numeric(unlist(df_P2[df_P2$Type=='Orig',][yname]))
yname <- "Ratio"
groupname <- "Type"
df_P2_Pos <- as.numeric(unlist(df_P2[df_P2$Type=='Orig',][yname]))
df_P2_Pos
df_P2_Pos <- as.numeric(unlist(df_P2[df_P2$Type=='Multi_orig',][yname]))
df_P2_Pos
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df <- get_df_WT(df)
df <- get_df_Pos(df)
df <- get_rid_of_rand(df)
yname <- "Ratio"
groupname <- "Type"
outfile <- paste(project_directory,"3_pos.txt")
sink(file=outfile)
Comp_Type_at_each_Age_pairedT(df,yname,groupname)
Comp_Type_at_each_Age_pairedT <- function(df,yname,groupname){
df_P2 <- get_df_P2(df)
df_P4 <- get_df_P4(df)
df_P8 <- get_df_P8(df)
#
if (groupname=="CTB"){
df_P2_Pos <- as.numeric(unlist(df_P2[df_P2$CTB=='Pos',][yname]))
df_P2_Neg <- as.numeric(unlist(df_P2[df_P2$CTB=='Neg',][yname]))
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,alternative='greater',paired=TRUE)
print(df_P2.t)
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,paired=TRUE)
print(df_P2.t)
df_P4_Pos <- as.numeric(unlist(df_P4[df_P4$CTB=='Pos',][yname]))
df_P4_Neg <- as.numeric(unlist(df_P4[df_P4$CTB=='Neg',][yname]))
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,alternative='greater',paired=TRUE)
print(df_P4.t)
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,paired=TRUE)
print(df_P4.t)
df_P8_Pos <- as.numeric(unlist(df_P8[df_P8$CTB=='Pos',][yname]))
df_P8_Neg <- as.numeric(unlist(df_P8[df_P8$CTB=='Neg',][yname]))
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,alternative='greater',paired=TRUE)
print(df_P8.t)
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,paired=TRUE)
print(df_P8.t)
}
if (groupname=="Type"){
df_P2_Pos <- as.numeric(unlist(df_P2[df_P2$Type=='Multi_orig',][yname]))
df_P2_Neg <- as.numeric(unlist(df_P2[df_P2$Type=='Singl_orig',][yname]))
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,alternative='greater',paired=TRUE)
print(df_P2.t)
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,paired=TRUE)
print(df_P2.t)
df_P4_Pos <- as.numeric(unlist(df_P4[df_P4$Type=='Multi_orig',][yname]))
df_P4_Neg <- as.numeric(unlist(df_P4[df_P4$Type=='Singl_orig',][yname]))
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,alternative='greater',paired=TRUE)
print(df_P4.t)
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,paired=TRUE)
print(df_P4.t)
df_P8_Pos <- as.numeric(unlist(df_P8[df_P8$Type=='Multi_orig',][yname]))
df_P8_Neg <- as.numeric(unlist(df_P8[df_P8$Type=='Singl_orig',][yname]))
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,alternative='greater',paired=TRUE)
print(df_P8.t)
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,paired=TRUE)
print(df_P8.t)
}
}
{
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df <- get_df_WT(df)
df <- get_df_Pos(df)
df <- get_rid_of_rand(df)
yname <- "Ratio"
groupname <- "Type"
outfile <- paste(project_directory,"3_pos.txt")
sink(file=outfile)
Comp_Type_at_each_Age_pairedT(df,yname,groupname)
sink(NULL)
}
sink(NULL)
{
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df <- get_df_WT(df)
df <- get_df_Pos(df)
df <- get_rid_of_rand(df)
yname <- "Ratio"
groupname <- "Type"
outfile <- paste(project_directory,"3_WT_Pos.txt")
sink(file=outfile)
Comp_Type_at_each_Age_pairedT(df,yname,groupname)
sink(NULL)
}
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
setwd("E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/")
source("./8.6_Statistics_revisit.R")
get_rid_of_rand <- function(df){
return(df[(df$Type=='Multi_orig' | df$Type=='Singl_orig'),])
}
Comp_Type_at_each_Age_pairedT <- function(df,yname,groupname){
df_P2 <- get_df_P2(df)
df_P4 <- get_df_P4(df)
df_P8 <- get_df_P8(df)
#
if (groupname=="CTB"){
df_P2_Pos <- as.numeric(unlist(df_P2[df_P2$CTB=='Pos',][yname]))
df_P2_Neg <- as.numeric(unlist(df_P2[df_P2$CTB=='Neg',][yname]))
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,alternative='greater',paired=TRUE)
print(df_P2.t)
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,paired=TRUE)
print(df_P2.t)
df_P4_Pos <- as.numeric(unlist(df_P4[df_P4$CTB=='Pos',][yname]))
df_P4_Neg <- as.numeric(unlist(df_P4[df_P4$CTB=='Neg',][yname]))
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,alternative='greater',paired=TRUE)
print(df_P4.t)
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,paired=TRUE)
print(df_P4.t)
df_P8_Pos <- as.numeric(unlist(df_P8[df_P8$CTB=='Pos',][yname]))
df_P8_Neg <- as.numeric(unlist(df_P8[df_P8$CTB=='Neg',][yname]))
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,alternative='greater',paired=TRUE)
print(df_P8.t)
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,paired=TRUE)
print(df_P8.t)
}
if (groupname=="Type"){
df_P2_Pos <- as.numeric(unlist(df_P2[df_P2$Type=='Multi_orig',][yname]))
df_P2_Neg <- as.numeric(unlist(df_P2[df_P2$Type=='Singl_orig',][yname]))
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,alternative='greater',paired=TRUE)
print(df_P2.t)
df_P2.t <- t.test(df_P2_Pos,df_P2_Neg,paired=TRUE)
print(df_P2.t)
df_P4_Pos <- as.numeric(unlist(df_P4[df_P4$Type=='Multi_orig',][yname]))
df_P4_Neg <- as.numeric(unlist(df_P4[df_P4$Type=='Singl_orig',][yname]))
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,alternative='greater',paired=TRUE)
print(df_P4.t)
df_P4.t <- t.test(df_P4_Pos,df_P4_Neg,paired=TRUE)
print(df_P4.t)
df_P8_Pos <- as.numeric(unlist(df_P8[df_P8$Type=='Multi_orig',][yname]))
df_P8_Neg <- as.numeric(unlist(df_P8[df_P8$Type=='Singl_orig',][yname]))
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,alternative='greater',paired=TRUE)
print(df_P8.t)
df_P8.t <- t.test(df_P8_Pos,df_P8_Neg,paired=TRUE)
print(df_P8.t)
}
}
#Figure 3, revisit, experiment 10:
{
{
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df <- get_df_WT(df)
df <- get_df_Pos(df)
df <- get_rid_of_rand(df)
yname <- "Ratio"
groupname <- "Type"
outfile <- paste(project_directory,"3_WT_Pos.txt")
sink(file=outfile)
Comp_Type_at_each_Age_pairedT(df,yname,groupname)
sink(NULL)
}
{
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df <- get_df_B2(df)
df <- get_df_Pos(df)
df <- get_rid_of_rand(df)
yname <- "Ratio"
groupname <- "Type"
outfile <- paste(project_directory,"3_B2_Pos.txt")
sink(file=outfile)
Comp_Type_at_each_Age_pairedT(df,yname,groupname)
sink(NULL)
}
{
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df <- get_df_WT(df)
df <- get_df_Neg(df)
df <- get_rid_of_rand(df)
yname <- "Ratio"
groupname <- "Type"
outfile <- paste(project_directory,"3_WT_Neg.txt")
sink(file=outfile)
Comp_Type_at_each_Age_pairedT(df,yname,groupname)
sink(NULL)
}
{
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename,sheet=1)
df <- get_df_B2(df)
df <- get_df_Neg(df)
df <- get_rid_of_rand(df)
yname <- "Ratio"
groupname <- "Type"
outfile <- paste(project_directory,"3_B2_Neg.txt")
sink(file=outfile)
Comp_Type_at_each_Age_pairedT(df,yname,groupname)
sink(NULL)
}
}
df <- get_rid_of_rand(df)
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
setwd(Code_directory)
source("./8.6_Statistics_revisit.R")
source("./8.7_Statistics_revisit_V2.R")
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename)
filename
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
filename
df <- read.xlsx(filename)
df <- get_rid_of_rand(df)
df_P2 <- get_df_P2(df)
df_P2_2 <- data_summary(df_P2,'Ratio','Type')
getwd()
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
setwd(Code_directory)
source("./8.6_Statistics_revisit.R")
file.exists(Code_directory)
Code_directory
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
setwd(Code_directory)
source("./8.6_Statistics_revisit.R")
getwd
getwd()
Code_directory
Code_directory
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
Code_directory
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
setwd(Code_directory)
source("./8.6_Statistics_revisit.R")
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
setwd(Code_directory)
source("./8.6_stats_func.R")
source("./Func_Def_Experiment_2.1.a.R")
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename)
df <- get_rid_of_rand(df)
df_P2 <- get_df_P2(df)
df_P2_2 <- data_summary(df_P2,'Ratio','Type')
df_P2_2
ggplot(data=df_P2_2,aes(x=Type,y=Ratio)) +
geom_bar(stat='identity') +
geom_errorbar(aes(ymin=Ratio-se,ymax=Ratio+se),width=.5) +
geom_point(data=df) +
geom_line(data=df,aes(group=Name)) +
coord_cartesian(ylim=c(0.0,1.0)) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library(openxlsx)
project_directory <- "E:/File/Work/2024/eLife manuscript/Experiment_10_Figure3_normalized/"
Code_directory <- "E:/File/Work/2024/eLife manuscript/Cluster_spatial_distribution/R_Functions/"
setwd(Code_directory)
source("./8.6_stats_func.R")
source("./Func_Def_Experiment_2.1.a.R")
Exp10_plot <- function(df,project_directory,lim1,lim2,lim3){
df <- get_rid_of_rand(df)
df_P2 <- get_df_P2(df)
df_P2_2 <- data_summary(df_P2,'Ratio','Type')
df_P4 <- get_df_P4(df)
df_P4_2 <- data_summary(df_P4,'Ratio','Type')
df_P8 <- get_df_P8(df)
df_P8_2 <- data_summary(df_P8,'Ratio','Type')
outpath <- project_directory
Exp10_plot_core(df_P2_2,df_P2,outpath,lim1)
Exp10_plot_core(df_P4_2,df_P4,outpath,lim2)
Exp10_plot_core(df_P8_2,df_P8,outpath,lim3)
}
Exp10_plot_core <- function(df_2,df,outpath,lim){
ggplot(data=df_2,aes(x=Type,y=Ratio)) +
geom_bar(stat='identity') +
geom_errorbar(aes(ymin=Ratio-se,ymax=Ratio+se),width=.5) +
geom_point(data=df) +
geom_line(data=df,aes(group=Name)) +
coord_cartesian(ylim=lim) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
name_string <- deparse(substitute(df))
name_string <- paste(name_string,"_P2",sep="")
ggsave(path = outpath,filename=paste(name_string,".eps",sep=""))
ggsave(path = outpath,filename=paste(name_string,".png",sep=""))
}
#Data preparation
filename <- paste(project_directory,"Raw_2.xlsx",sep="")
df <- read.xlsx(filename)
df_Pos <- get_df_Pos(df)
df_Neg <- get_df_Neg(df)
#Figure: ratio of clustered multi-AZ synapses
df_Pos_WT <- get_df_WT(df_Pos)
df_Pos_B2 <- get_df_B2(df_Pos)
df_Neg_WT <- get_df_WT(df_Neg)
df_Neg_B2 <- get_df_B2(df_Neg)
Exp10_plot(df_Pos_WT,project_directory,c(0.2,0.6),c(0.2,0.6),c(0.2,0.6))
Exp10_plot(df_Pos_WT,project_directory,c(0.2,0.61),c(0.2,0.61),c(0.2,0.61))
Exp10_plot(df_Pos_B2,project_directory,c(0,0.41),c(0,0.41),c(0,0.41))
Exp10_plot(df_Neg_WT,project_directory,c(0,0.31),c(0,0.31),c(0,0.31))
Exp10_plot(df_Neg_B2,project_directory,c(0,0.21),c(0,0.21),c(0,0.21))
