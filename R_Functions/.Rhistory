data_sum <- ddply(data,groupnames,.fun=summary_func,varname)
data_sum <- rename(data_sum,c("mean"=varname))
return(data_sum)
}
Plot_orig_rand_comp_one_Name <- function(data,name,outpath){
df_target <- df[df$Name == name,]
df_target_2 <- data_summary(df_target,'length','DataType')
level_order <- c('Orig','Rand')
ggplot(data=df_target_2,aes(x=factor(DataType,level=level_order),y=Values)) +
geom_bar(stat='identity',na.rm=TRUE) +
geom_errorbar(aes(ymin=Values-Margin_error, ymax=Values+Margin_error), width=.5) +
geom_point(data=df_target,position=position_dodge(width=0.9),size = 2) +
ggtitle(name) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
ggsave(path = outpath,filename= paste(name,".tiff",sep=""))
ggsave(path = outpath,filename= paste(name,".eps",sep=""))
}
Plot_orig_rand_comp_one_Name(df,'He_P8_A',outpath)
Plot_orig_rand_comp_one_Name <- function(data,name,outpath){
df_target <- df[df$Name == name,]
df_target_2 <- data_summary(df_target,'length','DataType')
level_order <- c('Orig','Rand')
ggplot(data=df_target_2,aes(x=factor(DataType,level=level_order),y=length)) +
geom_bar(stat='identity',na.rm=TRUE) +
geom_errorbar(aes(ymin=length-Margin_error, ymax=length+Margin_error), width=.5) +
geom_point(data=df_target,position=position_dodge(width=0.9),size = 2) +
ggtitle(name) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
ggsave(path = outpath,filename= paste(name,".tiff",sep=""))
ggsave(path = outpath,filename= paste(name,".eps",sep=""))
}
Plot_orig_rand_comp_one_Name(df,'He_P8_A',outpath)
Plot_orig_rand_comp_one_Name(df,'He_P8_B',outpath)
Plot_orig_rand_comp_one_Name(df,'He_P8_C',outpath)
Plot_orig_rand_comp_one_Name(df,'He_60_A',outpath)
Plot_orig_rand_comp_one_Name(df,'He_60_B',outpath)
Plot_orig_rand_comp_one_Name(df,'He_60_C',outpath)
Plot_orig_rand_comp_one_Name(df,'KO_P8_A',outpath)
Plot_orig_rand_comp_one_Name(df,'KO_P8_B',outpath)
Plot_orig_rand_comp_one_Name(df,'KO_P8_C',outpath)
Plot_orig_rand_comp_one_Name(df,'KO_60_A',outpath)
Plot_orig_rand_comp_one_Name(df,'KO_60_B',outpath)
Plot_orig_rand_comp_one_Name(df,'KO_60_C',outpath)
df
name <- 'He_P8_A'
df_target <- df[df$Name == name,]
df_target
df_target_2 <- data_summary(df_target,'length','DataType')
df_target_2
level_order <- c('Orig','Rand')
ggplot(data=df_target_2,aes(x=factor(DataType,level=level_order),y=length)) +
geom_bar(stat='identity',na.rm=TRUE) +
geom_errorbar(aes(ymin=length-Margin_error, ymax=length+Margin_error), width=.5) +
geom_point(data=df_target,position=position_dodge(width=0.9),size = 2) +
ggtitle(name) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df_orig <- df[df$DataType=='Orig',]
df_orig_2 <-data_summary(df_orig,'length','No_Sample')
order_level <- c('He_P8','KO_P8','He_60','KO_60')
ggplot(data=df_orig_2,aes(x=factor(No_Sample,ordered=order_level),y=length)) +
geom_bar(stat='identity') +
geom_errorbar(aes(ymin=length-se,ymax=length+se)) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
ggplot(data=df_orig_2,aes(x=factor(No_Sample,ordered=order_level),y=length)) +
geom_bar(stat='identity')
df_orig_2
rlang::last_trace()
df_orig <- df[df$DataType=='Orig',]
df_orig_2 <-data_summary(df_orig,'length','No_Sample')
order_level <- c('He_P8','KO_P8','He_60','KO_60')
ggplot(data=df_orig_2,aes(x=factor(No_Sample,level=order_level),y=length)) +
geom_bar(stat='identity') +
geom_errorbar(aes(ymin=length-se,ymax=length+se)) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df_orig <- df[df$DataType=='Orig',]
df_orig_2 <-data_summary(df_orig,'length','No_Sample')
order_level <- c('He_P8','KO_P8','He_60','KO_60')
ggplot(data=df_orig_2,aes(x=factor(No_Sample,level=order_level),y=length)) +
geom_bar(stat='identity') +
geom_point(data=df_orig) +
geom_errorbar(aes(ymin=length-se,ymax=length+se),width = .5) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
ggplot(data=df_orig_2,aes(x=factor(No_Sample,level=order_level),y=length)) +
geom_bar(stat='identity') +
geom_point(data=df_orig,size=.5) +
geom_errorbar(aes(ymin=length-se,ymax=length+se),width = .5) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df_orig <- df[df$DataType=='Orig',]
df_orig_2 <-data_summary(df_orig,'length','No_Sample')
order_level <- c('He_P8','KO_P8','He_60','KO_60')
ggplot(data=df_orig_2,aes(x=factor(No_Sample,level=order_level),y=length)) +
geom_bar(stat='identity') +
geom_point(data=df_orig,size=3) +
geom_errorbar(aes(ymin=length-se,ymax=length+se),width = .5) +
coord_cartesian(ylim=c(0.0,11.0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
ggsave(path = outpath,filename='Orig_all.tiff')
ggsave(path = outpath,filename='Orig_all.eps')
df_orig
df_orig_HeP8A <- df_orig[df_orig$Name=='He_P8_A',]
ggplot() +
geom_segment(aes(x=0,y=0,xend=df_orig_HeP8A$x,yend=-df_orig_HeP8A$y),arrow=arrow(length=unit(0.5,"cm")))
ggplot() +
geom_segment(aes(x=0,y=0,xend=df_orig$x,yend=-df_orig$y),arrow=arrow(length=unit(0.5,"cm")))
df_orig_HeP8A <- df_orig[df_orig$Name=='He_P8_A',]
ggplot(data=df_orig_HeP8A,aes(x=0,y=0,xend=x,yend=-$y)) +
df_orig_HeP8A <- df_orig[df_orig$Name=='He_P8_A',]
df_orig_HeP8A$y <- - df_orig_HeP8A$y
ggplot(data=df_orig_HeP8A,aes(x=0,y=0,xend=x,yend=-y)) +
geom_segment(arrow=arrow(length=unit(0.5,"cm"))) +
coord_cartesian(ylim=c(-11.0,11.0)) + coord_cartesian(xlim=c(-11.0,11.0)) +
theme_classic()
df_orig_HeP8A
df_orig_HeP8A <- df_orig[df_orig$Name=='He_P8_A',]
ggplot(data=df_orig_HeP8A,aes(x=0,y=0,xend=x,yend=-y)) +
geom_segment(arrow=arrow(length=unit(0.5,"cm"))) +
coord_cartesian(ylim=c(-11.0,11.0)) + coord_cartesian(xlim=c(-11.0,11.0)) +
theme_classic()
df_orig_HeP8A
ggplot(data=df_orig_HeP8A,aes(x=0,y=0,xend=x,yend=-y)) +
geom_segment(arrow=arrow(length=unit(0.5,"cm"))) +
coord_cartesian(xlim=c(-11.0,11.0),ylim=c(-11.0,11.0)) +
theme_classic()
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
#library(dplyr)
filename <- "D:/Reaearch/Projects/Project_5_OPN4-SCN/Non_retinal/Experiment_3/P8_retinal_Synapse_Density/data_Vglut2_Added_1_eye_injection.xlsx"
df <- read_excel(filename,sheet = "data_Vglut2")
data_summary <- function(data,varname,groupnames){
require(plyr)
summary_func <- function(x,col){
c(mean = mean(x[[col]],na.rm=TRUE), se = (sd(x[[col]],na.rm=TRUE))/sqrt(3))
}
data_sum <- ddply(data,groupnames,.fun=summary_func,varname)
data_sum <- rename(data_sum,c("mean"=varname))
return(data_sum)
}
df <- df[df['Age']=='P8',]
df_2 <- data_summary(df,'Density','Genotype')
level_order <- c('Het','KO')
p <- ggplot(data=df_2,aes(x=factor(Genotype,level=level_order),y=Density)) +
geom_bar(stat='identity',na.rm=TRUE,position=position_dodge(0.9)) +
geom_errorbar(data=df_2,aes(ymin=Density-se, ymax=Density+se), width=.3,position=position_dodge(0.9)) +
geom_point(data=df,position=position_dodge(width=0.9),size = 2) +
coord_cartesian(ylim=c(0.0,0.08)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
print(p)
p <- ggplot(data=df_2,aes(x=factor(Genotype,level=level_order),y=Density)) +
geom_bar(stat='identity',na.rm=TRUE,position=position_dodge(0.9)) +
geom_errorbar(data=df_2,aes(ymin=Density-se, ymax=Density+se), width=.3,position=position_dodge(0.9)) +
geom_point(data=df,position=position_dodge(width=0.9),size = 2) +
coord_cartesian(ylim=c(0.0,0.04)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
print(p)
ggsave(path = "D:/Reaearch/Projects/Project_5_OPN4-SCN/Non_retinal/Experiment_3/P8_retinal_Synapse_Density/",filename="Density.eps")
ggsave(path = "D:/Reaearch/Projects/Project_5_OPN4-SCN/Non_retinal/Experiment_3/P8_retinal_Synapse_Density/",filename="Density.tiff")
library(readxl)
library(ggplot2)
library(ggdist)
library(plyr)
library("xlsx")
library(plyr)
library(xlsx)
install.packages("xlsx")
library(xlsx)
library(xlsx)
library(xlsx)
__version__
library(ggplot2)
library(readxl)
library(dplyr)
library(tidyr)
project_directory <- "D:/Research/Projects/Project_17_4_color_continue/"
Code_directory <- paste(project_directory,"Cluster_spatial_distribution/R_Functions/",sep="")
setwd(Code_directory)
#source("./Func_Def_Experiment_5.R")
in_directory <- paste(project_directory,"Data/Experiment_7/Reconstructed/",sep="")
infile_neg_neg <- paste(in_directory,"Neg_neg.csv",sep="")
infile_neg_pos <- paste(in_directory,"Neg_pos.csv",sep="")
infile_pos_neg <- paste(in_directory,"Pos_neg.csv",sep="")
infile_pos_pos <- paste(in_directory,"Pos_pos.csv",sep="")
df <- read.csv(infile_neg_neg)
df <- filter(df,!is.na(trans1))
df
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_1_1 <- df_2[df_2$Type == 'Clustred']
df_2 <- df[df$No_sample == No_Sample_Name,]
df_1_1 <- df_2[df_2$Type == 'Clustred',]
df_2_2 <- df_2[df_2$Type == 'Isolated',]
df_1_1
colors <- c("1" = "#000000","2" = "#FF0000")
ggplot(aes(x=Sort,y=Cumsum)) +
geom_line(data = df_2_Clu,aes(color="1"),na.rm=TRUE,size=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,size=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors)
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu_Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso_Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
df_2_Iso_Cumsum
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
df_2_Iso
colors <- c("1" = "#000000","2" = "#FF0000")
ggplot(aes(x=Sort,y=Cumsum)) +
geom_line(data = df_2_Clu,aes(color="1"),na.rm=TRUE,size=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,size=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors)
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(aes(x=Sort,y=Cumsum)) +
geom_line(data = df_2_Clu,aes(color="1"),na.rm=TRUE,size=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,size=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(aes(x=Sort,y=Cumsum)) +
geom_line(data = df_2_Clu,aes(color="1"),na.rm=TRUE,size=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,size=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,size=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,size=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.1)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,12.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_pos_pos)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_pos_neg)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_neg_pos)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_neg_neg)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
No_Sample_Name = 'B2P4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_neg_neg)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_neg_pos)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_pos_neg)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
df <- read.csv(infile_pos_pos)
df <- filter(df,!is.na(trans1))
No_Sample_Name = 'WTP4'
df_2 <- df[df$No_sample == No_Sample_Name,]
df_2_Clu <- df_2[df_2$Type == 'Clustred',]
df_2_Iso <- df_2[df_2$Type == 'Isolated',]
df_2_Clu$Sort <- sort(df_2_Clu$trans1,na.last=TRUE)
df_2_Clu <- drop_na(df_2_Clu,Sort)
df_2_Clu$Cumsum <- cumsum(df_2_Clu$Sort / sum(df_2_Clu$Sort))
df_2_Iso$Sort <- sort(df_2_Iso$trans1,na.last=TRUE)
df_2_Iso <- drop_na(df_2_Iso,Sort)
df_2_Iso$Cumsum <- cumsum(df_2_Iso$Sort / sum(df_2_Iso$Sort))
colors <- c("1" = "#FF0000","2" = "#000000")
ggplot(data = df_2_Clu,aes(x=Sort,y=Cumsum)) +
geom_line(aes(color="1"),na.rm=TRUE,linewidth=1) +
geom_line(data = df_2_Iso,aes(color="2"),na.rm=TRUE,linewidth=1) +
labs(color = "Legend") +
coord_cartesian(ylim=c(0.0,1.0),xlim=c(0.0,9.0)) +
scale_color_manual(values=colors) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
